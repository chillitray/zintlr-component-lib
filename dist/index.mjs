import X,{createContext,useContext,useState,useEffect,useMemo,useCallback}from'react';import {Toaster,toast}from'sonner';export{toast}from'sonner';import {utils,writeFile,read}from'xlsx';import y from'moment';import {useRouter}from'next/router';import se from'axios';import*as ae from'yup';import*as V from'jsonwebtoken';var me=({position:e="bottom-right",expand:t=false,richColors:r=true,closeButton:n=true,...o})=>X.createElement(Toaster,{position:e,expand:t,richColors:r,closeButton:n,...o});var ge=({children:e,className:t="",id:r=""})=>X.createElement("div",{id:r,className:"border w-full h-fit bg-white rounded-lg"},X.createElement("div",{className:`p-3 sm:p-7 mb-2 ${t}`},e));function de(e){let t={JVBERi0:"application/pdf",R0lGODdh:"image/gif",R0lGODlh:"image/gif",iVBORw0KGgo:"image/png",AAAA:"video/mp4","/":"image/jpg",i:"image/png",R:"image/gif",U:"image/webp",J:"application/pdf",A:"video/mp4",UEsDBBQA:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;"};for(let r in t){let n=e.indexOf(r);if(n===0||n===1)return t[r]}}var he=e=>"data:"+de(e)+";base64,"+e;var xe=e=>e.charAt(0).toUpperCase()+e.slice(1);var Ce=e=>{let t;return Array.isArray(e)?(e&&(t=e==null?void 0:e.filter(r=>r)),t):[]};var F=[{key:"no_contact_lists",label:"No Contact Lists"},{key:"download_export",label:"Download & Export"},{key:"tags_types",label:"Tags & Types"},{key:"credit",label:"Credits"},{key:"magic_search",label:"Domain Search"},{key:"personality_intel",label:"Personality Intel"},{key:"zbizlocator",label:"Local Search"}],ye=(e,t)=>{let r=t.filter(({isNonEditable:o,name:s})=>!o&&s!=="Unallocated credits").reduce((o,{limits:s})=>(F.forEach(({key:a})=>{let p=Number(s[a])||0;o[a]=(o[a]||0)+p;}),o),{}),n=F.filter(({key:o})=>(r[o]||0)>100);if(n.length){let o=n.map(({key:s,label:a})=>`${a} (${r[s]}%)`);return toast.error(`The following limits exceed 100%: ${o.join(", ")}.`),false}return  true};var x=()=>typeof window<"u";var _e=()=>{if(x()){var e=document.getElementsByClassName("cc-157aw cc-1kgzy");e&&e.length>0&&e[0].click();}};var be=(e,t)=>{if(!e||!t||Object.keys(e).length===0||Object.keys(t).length===0)return [];let r=e.team_limits||[],n=e.invite_limits||[],o=[...r.map(s=>({...s,isInvited:false})),...n.map(s=>({...s,isInvited:true}))];return o.push({...t,name:"Unallocated credits",isNonEditable:true}),o},Ie=e=>{let t={},r={};return Object.entries(e).forEach(([n,o])=>{o.isInvited?(r[o.email]={...o},delete r[o.email].isInvited,delete r[o.email].email):(t[n]={...o},delete t[n].isInvited);}),{credit_limits:{team_limits:t,invite_limits:r}}};function ve(e,t="Email"){if(!x())return  false;try{if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(e),toast.success(`${t} copied to clipboard`),!0;let r=document.createElement("textarea");r.value=e,r.style.position="fixed",r.style.left="-999999px",r.style.top="-999999px",document.body.appendChild(r),r.focus(),r.select();let n=document.execCommand("copy");return r.remove(),n?(toast.success(`${t} copied to clipboard`),!0):(toast.error("Failed to copy to clipboard"),!1)}catch{return toast.error("Failed to copy to clipboard"),false}}function Se(){let e=navigator.userAgent,t;return e.match(/chrome|chromium|crios/i)?t="chrome":e.match(/firefox|fxios/i)?t="firefox":e.match(/safari/i)?t="safari":e.match(/opr\//i)?t="opera":e.match(/edg/i)?t="edge":t="No browser detection",t}var Le=`
<g clip-path="url(#0cf21cfe8e)" transform="translate(5, 20) scale(0.5)">
<path fill="#ffffff" d="M 238.238281 215.71875 C 255.039062 215.71875 270.484375 215.71875 285.882812 215.570312 C 286.886719 215.328125 287.800781 214.894531 288.625 214.265625 C 289.445312 213.636719 290.101562 212.863281 290.59375 211.953125 C 299.421875 196.890625 308.148438 181.828125 316.625 166.765625 C 317.03125 165.753906 317.234375 164.703125 317.234375 163.613281 C 317.234375 162.523438 317.03125 161.472656 316.625 160.464844 C 315.144531 157.265625 313.421875 154.203125 311.457031 151.273438 C 310.230469 153.007812 309.175781 154.238281 308.375 155.617188 C 300.523438 169.425781 292.5 183.234375 284.980469 197.140625 C 282.472656 201.761719 279.585938 203.820312 274.347656 203.191406 C 270.242188 202.960938 266.140625 202.960938 262.035156 203.191406 C 278.382812 174.09375 294.382812 145.828125 310.957031 116.703125 C 319.984375 132.296875 328.507812 146.832031 336.757812 161.59375 C 337.011719 162.59375 337.054688 163.601562 336.882812 164.621094 C 336.714844 165.640625 336.347656 166.578125 335.78125 167.441406 C 324.261719 187.675781 312.621094 207.84375 300.851562 227.945312 C 300.253906 229.003906 299.464844 229.890625 298.484375 230.609375 C 297.503906 231.328125 296.421875 231.8125 295.234375 232.0625 C 266.898438 232.339844 238.566406 232.265625 208.976562 232.265625 C 213.664062 224.003906 217.828125 216.523438 222.117188 209.117188 C 241.046875 176.304688 259.804688 143.316406 279.136719 110.855469 C 282.773438 104.730469 283.425781 100.109375 278.910156 94.738281 C 277.597656 92.972656 276.402344 91.132812 275.324219 89.214844 L 183.777344 248.082031 L 289.265625 248.082031 C 283.675781 257.769531 278.785156 266.558594 273.644531 275.269531 C 269.910156 281.644531 267.402344 290.332031 261.808594 293.546875 C 256.21875 296.757812 247.441406 294.652344 240.070312 294.675781 L 101.679688 294.675781 C 148.996094 212.730469 195.710938 131.792969 243.027344 49.773438 L 131.972656 49.773438 C 120.035156 49.773438 120.035156 49.773438 115.171875 61.75 L 219.960938 61.75 L 98.722656 272.15625 C 89.71875 256.515625 81.167969 242.03125 72.96875 227.09375 C 72.609375 225.941406 72.496094 224.765625 72.636719 223.566406 C 72.777344 222.367188 73.15625 221.25 73.773438 220.214844 C 93.011719 186.574219 112.347656 153 131.769531 119.492188 C 133.125 117.132812 134.277344 114.695312 136.109375 111.507812 C 119.632812 111.507812 104.214844 111.507812 88.792969 111.632812 C 87.761719 111.773438 86.804688 112.121094 85.929688 112.683594 C 85.050781 113.246094 84.335938 113.96875 83.777344 114.847656 C 74.851562 130.011719 66.058594 145.273438 57.398438 160.640625 C 57.019531 161.558594 56.828125 162.519531 56.828125 163.511719 C 56.828125 164.507812 57.019531 165.46875 57.398438 166.386719 C 59.101562 169.855469 61.015625 173.203125 63.140625 176.429688 C 66 171.410156 68.480469 167.390625 70.863281 163.175781 C 77.234375 152.027344 83.800781 140.980469 89.769531 129.609375 C 89.945312 129.164062 90.15625 128.738281 90.40625 128.328125 C 90.65625 127.917969 90.9375 127.535156 91.25 127.175781 C 91.566406 126.816406 91.910156 126.484375 92.28125 126.183594 C 92.652344 125.882812 93.046875 125.617188 93.464844 125.382812 C 93.882812 125.148438 94.316406 124.953125 94.765625 124.796875 C 95.21875 124.636719 95.679688 124.519531 96.152344 124.441406 C 96.621094 124.363281 97.097656 124.324219 97.574219 124.328125 C 98.054688 124.332031 98.527344 124.378906 98.996094 124.460938 C 103.035156 124.789062 107.121094 124.460938 112.210938 124.460938 C 95.613281 153.359375 79.742188 181.527344 63.242188 210.597656 C 55.71875 197.441406 48.972656 184.816406 41.226562 172.941406 C 36.8125 166.210938 36.886719 161.34375 41.226562 154.464844 C 52.332031 136.539062 62.539062 118.035156 73.046875 99.660156 C 73.40625 98.839844 73.882812 98.101562 74.476562 97.433594 C 75.070312 96.765625 75.75 96.207031 76.519531 95.757812 C 77.292969 95.308594 78.113281 94.984375 78.984375 94.792969 C 79.855469 94.601562 80.734375 94.550781 81.621094 94.636719 C 109.054688 94.886719 136.511719 94.761719 165.296875 94.761719 C 163.617188 97.953125 162.4375 100.363281 161.109375 102.671875 C 139.792969 139.625 118.882812 176.832031 96.890625 213.359375 C 91.148438 222.875 91.199219 229.726562 99.398438 237.613281 C 129.464844 185.015625 159.703125 132.519531 190.496094 79.070312 L 85.582031 79.070312 C 86.636719 76.761719 87.210938 75.230469 88.089844 73.824219 C 95.210938 61.273438 102.28125 48.84375 109.703125 36.542969 C 110.363281 35.5625 111.191406 34.761719 112.191406 34.140625 C 113.195312 33.519531 114.277344 33.132812 115.445312 32.980469 C 166.902344 32.792969 218.355469 32.753906 269.808594 32.851562 C 270.554688 32.957031 271.289062 33.109375 272.015625 33.304688 C 225.101562 114.671875 178.359375 195.710938 130.96875 277.753906 L 242.527344 277.753906 C 254.238281 277.753906 254.636719 277.453125 259.078125 265.203125 L 154.4375 265.203125 L 275.148438 55.625 C 276.265625 57.027344 277.3125 58.484375 278.285156 59.992188 C 285.605469 72.542969 292.753906 85.324219 300.273438 97.824219 C 300.796875 98.542969 301.195312 99.320312 301.472656 100.164062 C 301.746094 101.007812 301.882812 101.871094 301.882812 102.757812 C 301.882812 103.644531 301.746094 104.511719 301.472656 105.355469 C 301.195312 106.195312 300.796875 106.976562 300.273438 107.691406 C 280.566406 141.484375 260.972656 175.402344 241.5 209.445312 C 240.546875 211.101562 239.742188 212.808594 238.238281 215.71875 Z M 238.238281 215.71875 " fill-opacity="1" fill-rule="nonzero" />
</g>`,K=(e,t=null)=>{let n=document.createElementNS("http://www.w3.org/2000/svg","svg");if(n.setAttributeNS(null,"width","200"),n.setAttributeNS(null,"height","200"),n.setAttributeNS(null,"fill","none"),n.setAttribute("style",`${t?`background:${t==null?void 0:t.bgColor}`:"background-image: linear-gradient(180deg, #112634 0%, #000000 100%)"};
		background-repeat:no-repeat !important;
		display: flex;
		align-items:center;`),e){let o="50%";x()&&Se()==="firefox"&&(o="55%"),n.innerHTML=`
			<text x="50%" y=${o} fill="${(t==null?void 0:t.textColor)??"white"}" style="font-weight: 700; text-transform: uppercase; font-family: 'Roboto', sans-serif;"
			dominant-baseline="middle"  text-anchor="middle" alignment-baseline="central" font-size="90">
				${e}
			</text>
		`;}else n.innerHTML=Le;return n},ke=e=>{let t,r=/^[A-Za-z0-9 ]*$/;if(e=e?e.replace(/[^a-zA-Z0-9 ]/g,""):"",r.test(e)){let o=e.trim().toUpperCase().split(" ");o=o.map(s=>s.trim()),t=o[0].charAt(0)+""+(o.length>1?o[o.length-1].charAt(0):""),t=String(t).toUpperCase();}return t},Ae=(e,t=null)=>{let r=ke(e);return r?K(r,t):K()},Ee=(e,t=null)=>{try{if(typeof window>"u"||!window.btoa||!window.XMLSerializer)return console.warn("createImg requires browser environment with btoa and XMLSerializer support"),"";if(e&&x()){let o=Ae(e,t);var r=new XMLSerializer().serializeToString(o),n=window.btoa(r);return "data:image/svg+xml;base64,"+n}}catch(o){console.warn("Error creating image:",o);}return ""};var Te=e=>typeof structuredClone=="function"?structuredClone(e):JSON.parse(JSON.stringify(e));var Oe=(e,t)=>{let r=t.map(s=>Object.values(s));r.unshift(Object.keys(t[0]));let n=r.join(`\r
`),o=document.createElement("a");o.href="data:attachment/csv,"+encodeURIComponent(n),o.target="_blank",o.download=e,o.click(),toast.success("Downloaded file successfully");};var De=(e,t)=>{if(Object.keys(t).length===0)return;let r=utils.book_new();Object.keys(t).map((o,s)=>{let a=o.length>31?o.slice(0,28)+`_${s}`:o,p=utils.json_to_sheet(t[o]);utils.book_append_sheet(r,p,a);});let n=e.trim().replace(".xlsx","")+".xlsx";writeFile(r,n),toast.success("Downloaded file successfully");};var $e={credit:"Lookup/Ids",magic_search:"Domain search",personality_intel:"Personality",zbizlocator:"Local search"},Pe=e=>e?Object.entries(e).map(([t,r])=>({name:$e[t]||t,...r})):[];var Ue=e=>[e==null?void 0:e.city,e==null?void 0:e.state,e==null?void 0:e.country].filter(r=>r).join(", ");var Ne=e=>[y.duration(e,"days").years()&&`${y.duration(e,"days").years()} year${y.duration(e,"days").years()>1?"s":""}`,y.duration(e,"days").months()&&`${y.duration(e,"days").months()} month${y.duration(e,"days").months()>1?"s":""}`,(y.duration(e,"days").days()>0||y.duration(e,"days").years()===0&&y.duration(e,"days").months()===0)&&`${y.duration(e,"days").days()} day${y.duration(e,"days").days()>1?"s":""}`].filter(Boolean).join(" ").trim();var Be=e=>e?new URL(e).hostname:"";var N=e=>new Date(e).toLocaleDateString("en-US",{day:"numeric",month:"long",year:"numeric"});var ze=e=>e?e.substr(0,4)!=="http"?"https://"+e:e:"";var Ve=e=>{var r,n,o;if(!Array.isArray(e))return [];let t=[];if((r=e[0])!=null&&r.invitation){let s=(n=e[0])==null?void 0:n.invitation;t.push({user_data:{email:s.send_to_email_id},role:s.role,invitation_status:s.invitation_status,create_datetime:s.invitation_status===2?s.create_datetime:null,team_invitations_id:s.team_invitations_id});}return (o=e[0])!=null&&o.invitation?t:e.map(s=>({user_data:{email:s.send_to_email_id},role:s.role,invitation_status:s.invitation_status,create_datetime:s.invitation_status===2?s.create_datetime:null,team_invitations_id:s.team_invitations_id}))};var Me=e=>N(y(e).add(1,"days").toISOString());var He=(e,t=new Date)=>{let r=y(t);return y(e).diff(r,"days")};var We=e=>{let t=document.cookie.split("; ");for(let r=0;r<t.length;r++){let n=t[r].split("=");if(n[0]===e)return n[1]}return ""};var Z=e=>!e.unlocked,Y=e=>e.unlocked,Je=(e=[],t=true)=>e.filter(r=>t?Y(r):Z(r));var Ke=(e,t=()=>{})=>{if(e){let r=new FileReader;r.readAsBinaryString?(r.onload=function(n){t(ee(n.target.result));},r.readAsBinaryString(e)):(r.onload=function(n){var o="",s=new Uint8Array(n.target.result);for(let a=0;a<s.byteLength;a++)o+=String.fromCharCode(s[a]);t(ee(o));},r.readAsArrayBuffer(e));}};function ee(e){let t=read(e,{type:"binary"}),r=t.SheetNames[0];return utils.sheet_to_row_object_array(t.Sheets[r])}var Qe=e=>{var r,n;let t=e;return t.includes("linkedin.com/in/")&&(t="https://linkedin.com/in/"+((r=t.replace(/(https?:\/\/(www.|de.)?linkedin.com\/(mwlite\/|m\/)?in\/\/?)/g,"").split("/"))==null?void 0:r[0])),t.includes("linkedin.com/company/")&&(t="https://linkedin.com/company/"+((n=t.replace(/(https?:\/\/(www.|de.)?linkedin.com\/(mwlite\/|m\/)?company\/\/?)/g,"").split("/"))==null?void 0:n[0])),t};var te={behavior:"smooth",block:"start",inline:"nearest"},Ze=e=>{let t=setInterval(()=>{let r=document.getElementById(e);r&&(clearInterval(t),r.scrollIntoView(te));},200);},Ye=e=>{x()&&(e.preventDefault(),document.querySelector(e.target.getAttribute("href")).scrollIntoView(te));};var B=(e,t)=>!e||!t?false:!!(e!=null&&e.trim().toLowerCase().includes(t==null?void 0:t.trim().toLowerCase())),et=(e=[],t)=>e.some(r=>typeof r=="object"?Object.values(r).some(n=>B(n,t)):B(r,t)),z=(e,t,r)=>{if(!e)return  false;let n=e.split("."),o;if(typeof t=="object"&&t[e]?o=t[e]:o=typeof t=="object"&&!Array.isArray(t)?t[n[0]]:t,!o)return  false;let s=false;if(Array.isArray(o))s=et(o,r);else if(typeof o=="object")if(n.length>1){let a=0,p,d={...t};for(;a<n.length-1;a++)p=n[a],d=d[p];if(o=d[n[a]],z("",o,r))return  true}else s=Object.values(o).some(a=>z("",a,r));else o+="",s=B(o,r);return s};var tt=e=>e.split("_").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ");var rt=(e,t,r="s")=>t+(e>1?r:"");var st=e=>{let[t,r]=useState(false);return useEffect(()=>{let n=new IntersectionObserver(([o])=>{t||r(o.isIntersecting);});return e.current&&!t?n.observe(e.current):n.unobserve(e.current),()=>{n.disconnect();}},[t,e]),t};var lt=()=>{let{query:e}=useRouter();return useMemo(()=>e,[e])};var re=createContext({details:void 0,isLoggedIn:void 0,bannerData:void 0}),ft=()=>useContext(re);var dt=()=>{let[e,t]=useState({width:void 0,height:void 0}),r=useCallback(()=>{t({width:window.innerWidth,height:window.innerHeight});},[t]);return useEffect(()=>{if(x)return window.addEventListener("resize",r),r(),()=>window.removeEventListener("resize",r)},[r]),e};var oe=e=>{var t;return (t=e==null?void 0:e.phone)!=null&&t.length?typeof e.phone[0]=="string"?[["",e.phone]]:Object.entries(e.phone.reduce((r,{subtype:n="",ph:o})=>(o&&(r[n]||(r[n]=[]),r[n].push(o)),r),{})):[]},ne=e=>e==null?void 0:e.map(t=>({address:t})),ht=(e,t)=>{var r;return {name:(e==null?void 0:e.person_name)||(e==null?void 0:e.full_name),phone:oe((e==null?void 0:e.person_phs)||(e==null?void 0:e.phone)),emails:ne(e==null?void 0:e.person_emails)||(e==null?void 0:e.emails),_id:(e==null?void 0:e.person_din)||(e==null?void 0:e._id),info:{flags:e==null?void 0:e.person_flags,credits:(e==null?void 0:e.email_credits)+(e==null?void 0:e.phone_credits),email_credits:e==null?void 0:e.email_credits,phone_credits:e==null?void 0:e.phone_credits},linkedin_url:(r=e==null?void 0:e.social_urls)==null?void 0:r.linkedin_url,from:t,isEmailUnlocked:e==null?void 0:e.email_unlocked,isPhoneUnlocked:e==null?void 0:e.phone_unlocked}};function q(e,t){try{return V.verify(e,t)}catch{return null}}function O(e){var n;let t=e.ip??(e==null?void 0:e["x-real-ip"]),r=e==null?void 0:e["x-forwarded-for"];if(process.env.CLOUDFLARE_ENABLED==="true"&&(r=e==null?void 0:e["cf-connecting-ip"]),r)try{Array.isArray(r)?t=r==null?void 0:r[0]:t=(n=r.split(","))==null?void 0:n[0];}catch{t="Unknown";}return t||(t="Unknown"),t}var D={},$=false,xt=e=>{D={...e},$=true,console.log("\u2705 Validation configuration set successfully"),console.log(`\u{1F4CA} Configured ${Object.keys(e).length} validation rules`);},L=e=>{if(!$)return console.warn("\u26A0\uFE0F Validation config not initialized. Call setValidationConfig() first."),null;let t=D[e];return t||(console.warn(`\u26A0\uFE0F No validation schema found for endpoint: ${e}`),null)},Ct=()=>D,wt=()=>$,yt=()=>{D={},$=false;};var k={message:"",success:false,code:400,data:{}};function _t(e){return ["post","put","delete"].includes(e)}var ie=-100;function bt({method:e="post",endpoint:t="",data:r={},successToast:n=false,errorToast:o=true,headers:s={},controller:a=null,forceValidationSchema:p=null,skipValidation:d=false,domain:g=null,logFn:c=console.log}){return new Promise((C,w)=>{let u={...k};if(!_t(e)){u.message="Method is not allowed",w(u);return}c("Request:",{method:e,endpoint:t,data:r});let m=g??process.env.NEXT_PUBLIC_FRONTEND_URL+"/api/";if(!m){u.message="Domain is required",w(u);return}if(!d&&(L(t)||L(p))){let i=L(t);p&&(i=L(p));let l=ae.object().shape(i);try{l.validateSync(r),c("Validation passed",r);}catch(I){u.message=I.errors.join(", "),toast.error(u.message),w(u);return}}s&&Object.keys(s).length>0&&(r["browser-ip-address"]=O(s));let v={method:e,url:m+t,data:e!=="get"?r:{},responseType:"json",headers:s,withCredentials:true,crossDomain:true};return c("Request object:",v),a&&a instanceof AbortController&&(v.signal=a.signal),se.request(v).then(i=>{let l=i.data;l.success?(n&&toast.success(l.message),C(l)):(o&&toast.error(l.message),w(l));}).catch(i=>{var I,b,R,W,J;let l={};c&&(c("Request error:",i),c("Request object:",v)),i&&((I=i==null?void 0:i.response)==null?void 0:I.status)===0&&(i!=null&&i.message)?(u.message=i.message,l=u):i&&((R=(b=i==null?void 0:i.response)==null?void 0:b.data)==null?void 0:R.success)===false&&((J=(W=i==null?void 0:i.response)==null?void 0:W.data)!=null&&J.message)?l=i.response.data:se.isCancel(i)?(u.code=ie,u.message="Cancelled",l=u):(c&&(c("Request error:",i),c("Request object:",v)),u.message="Something went wrong on our side. Please try again. Sorry for the inconvenience",l=u),a&&a instanceof AbortController&&a.signal.aborted&&(l.code=ie),(!a||a&&a instanceof AbortController&&!a.signal.aborted)&&(c&&c("Error details:",l.message),o&&toast.error(l.message)),w(l);})})}function vt(e){let t={};return e&&e.split(";").forEach(r=>{let[n,o]=r.trim().split("=");n&&o&&(t[n]=decodeURIComponent(o));}),t}function St({method:e="get",endpoint:t="",data:r={},req:n=null,res:o=null,isAuthRequired:s=false,successCallback:a=()=>{},errorCallback:p=()=>{},isSourceRequired:d=false,logFn:g=console.log,apiUrl:c}){if(!n||!o)return;r={...n.body,...r,...d&&{source:process.env.NEXT_PUBLIC_PLATFORM_SOURCE}};let C={};C["Captcha-Token"]=process.env.NEXT_PUBLIC_CAPTCHA_TOKEN;let w=c??process.env.NEXT_PUBLIC_API_URL,u={method:e,url:w+t,headers:C},m=vt(n.headers.cookie);if(s){let i=n.headers.cookie;if(i&&(i=m.key&&m.access_token),!i){let b={...k};b.message="Log in first",b.code=400,o.status(b.code).json(b);return}let l=q(m.key,process.env.CIPHER),I=q(m.access_token,process.env.CIPHER);u.headers.Authorization=I,r.key=l;}if(m){let i=m["visitor-id"]||null;i&&(u.headers["visitor-id"]=i);}let v=r["browser-ip-address"]||O(n.headers);return r["browser-ip-address"]&&delete r["browser-ip-address"],u.headers["client-ip-address"]=v,r.ip_address=v,u={...u,params:e==="get"?r:{},data:e!=="get"?r:{},responseType:"json"},g&&g(u),se.request(u).then(i=>{var l;return (l=i==null?void 0:i.data)!=null&&l.success?(e==="get"&&o.setHeader("Cache-Control","public, s-maxage=59, stale-while-revalidate=59"),a(i.data),o.status(200).send(JSON.stringify(i.data))):o.status(400).json(i.data),i.data}).catch(i=>{var I,b,R;let l=((I=i==null?void 0:i.response)==null?void 0:I.data)||{...k};return g&&(g("================================================"),g(i),g("================================================")),i&&((b=i==null?void 0:i.response)==null?void 0:b.status)===0&&(i!=null&&i.message)&&(l={...k},l.message=i.message,l.code=500),i&&((R=i==null?void 0:i.response)==null?void 0:R.status)===502&&(l={...k},l.message="Server is down.",l.code=500),p(l),o.status((l==null?void 0:l.code)===500?500:400).json(l),l})}var f=null;function Lt(){f||(f={log:console.log.bind(console),warn:console.warn.bind(console),error:console.error.bind(console),info:console.info.bind(console)});}function A(){return f?(console.log=f.log,console.warn=f.warn,console.error=f.error,console.info=f.info,console.log("Emergency console restoration completed!"),true):false}Lt();var h=class{static log(t,...r){f&&f.log(`[LOGGER] ${t}`,...r);}static warn(t,...r){f&&f.warn(`[LOGGER] ${t}`,...r);}static error(t,...r){f&&f.error(`[LOGGER] ${t}`,...r);}static info(t,...r){f&&f.info(`[LOGGER] ${t}`,...r);}};typeof process<"u"&&(process.on("uncaughtException",e=>{A(),h.error("\u{1F6A8} Uncaught Exception - Console restored:",e.message);}),process.on("unhandledRejection",e=>{A(),h.error("\u{1F6A8} Unhandled Rejection - Console restored:",e);}),process.on("SIGINT",()=>{A(),h.log("\u{1F6A8} SIGINT received - Console restored"),process.exit(0);}),process.on("SIGTERM",()=>{A(),h.log("\u{1F6A8} SIGTERM received - Console restored"),process.exit(0);}));var P=new Map,_=null;function kt(e){try{if(!e)return "unknown";let t=e.split(`
`);for(let r=1;r<t.length;r++){let n=t[r];if(n.includes("pages/")||n.includes("lib/")||n.includes("src/")){let o=n.match(/([^/\\]+\.js):(\d+)/);if(o)return `${o[1]}:${o[2]}`}}return "unknown"}catch{return "unknown"}}var G=class{constructor(t){this.requestId=t.requestId,this.requestData=t,this.startTime=Date.now(),this.logs=[],this.isCapturing=false,this.cleanupTimeout=null,this.originalConsole=this.getOriginalConsole(),P.set(this.requestId,this);}getOriginalConsole(){if(f)return {log:f.log,warn:f.warn,error:f.error,info:f.info};throw new Error("Global console backup not available")}captureLog(t,r){let n={level:t,message:this.formatLogMessage(r),timestamp:new Date().toISOString(),file:this.extractFileName(new Error().stack),...t==="error"&&r[0]instanceof Error&&{stack:r[0].stack}};this.logs.push(n);}formatLogMessage(t){return t.map(r=>{if(typeof r=="object"&&r!==null)try{return JSON.stringify(r)}catch{return "[Object]"}return String(r)}).join(" ")}addLogPrefix(t,r){return `${{log:"\u{1F4DD}",info:"\u2139\uFE0F",warn:"\u26A0\uFE0F",error:"\u274C"}[t]||"\u{1F4DD}"} ${r}`}extractFileName(t){return kt(t)}startCapturing(){try{if(_&&_!==this.requestId){h.warn(`\u26A0\uFE0F Another logger ${_} is active. Stopping it first.`);let s=P.get(_);s&&s.forceStopCapturing(),this.forceRestoreConsole();}_=this.requestId;let t=(...s)=>this.captureLog("log",s),r=(...s)=>this.captureLog("warn",s),n=(...s)=>this.captureLog("error",s),o=(...s)=>this.captureLog("info",s);t.__requestId=this.requestId,r.__requestId=this.requestId,n.__requestId=this.requestId,o.__requestId=this.requestId,console.log=t,console.warn=r,console.error=n,console.info=o,this.isCapturing=!0,h.log(`\u{1F50D} Log capturing started for request: ${this.requestId}`),this.cleanupTimeout=setTimeout(()=>{h.warn(`\u26A0\uFE0F Request ${this.requestId} timed out, forcing console cleanup`),this.forceStopCapturing();},3e4);}catch(t){h.error(`Failed to start capturing for ${this.requestId}:`,t.message),this.forceRestoreConsole();}}stopCapturing(){try{if(!this.isCapturing){h.warn(`\u26A0\uFE0F Stop capturing called but not currently capturing for ${this.requestId}`);return}this.cleanupTimeout&&(clearTimeout(this.cleanupTimeout),this.cleanupTimeout=null),console.log=this.originalConsole.log,console.warn=this.originalConsole.warn,console.error=this.originalConsole.error,console.info=this.originalConsole.info,this.isCapturing=!1,_===this.requestId&&(_=null),this.verifyConsoleRestoration()?h.log(`\u{1F50D} Log capturing stopped for request: ${this.requestId}. Captured ${this.logs.length} logs.`):(h.error(`Console restoration verification failed for ${this.requestId}`),this.forceRestoreConsole()),P.delete(this.requestId);}catch(t){h.error(`Error stopping capture for ${this.requestId}:`,t.message),this.forceRestoreConsole();}}forceStopCapturing(){try{this.cleanupTimeout&&(clearTimeout(this.cleanupTimeout),this.cleanupTimeout=null),this.isCapturing=!1,_===this.requestId&&(_=null),this.forceRestoreConsole(),P.delete(this.requestId),this.printSummary(new Error("Emergency cleanup"));}catch{A(),_=null;}}forceRestoreConsole(){try{if(f)return console.log=f.log,console.warn=f.warn,console.error=f.error,console.info=f.info,h.log(`\u{1F527} Force restored console for request: ${this.requestId}`),!0}catch{A(),_=null;}return  false}verifyConsoleRestoration(){try{return console.log===this.originalConsole.log&&console.warn===this.originalConsole.warn&&console.error===this.originalConsole.error&&console.info===this.originalConsole.info}catch{return  false}}log(...t){this.captureLog("log",t);}info(...t){this.captureLog("info",t);}warn(...t){this.captureLog("warn",t);}error(...t){this.captureLog("error",t);}generateLogSummary(t=null){let n=Date.now()-this.startTime,o=this.logs.map(a=>({...a,message:this.addLogPrefix(a.level,a.message)})),s={requestId:this.requestId,timestamp:this.requestData.timestamp,duration:`${n}ms`,request:{method:this.requestData.method,url:this.requestData.url,userAgent:this.requestData.userAgent,ip:this.requestData.ip},totalLogs:o.length,logsByLevel:{log:o.filter(a=>a.level==="log").length,info:o.filter(a=>a.level==="info").length,warn:o.filter(a=>a.level==="warn").length,error:o.filter(a=>a.level==="error").length},logs:o};return t&&(s.error={message:t.message,stack:t.stack,timestamp:new Date().toISOString()}),s}printSummary(t=null){let r=this.generateLogSummary(t);return h.log(JSON.stringify(r)),r}getRequestId(){return this.requestId}getLogCount(){return this.logs.length}getLogs(){return [...this.logs]}},E=G;function T(){return typeof crypto<"u"&&crypto.randomUUID?crypto.randomUUID():"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){let t=Math.random()*16|0;return (e==="x"?t:t&3|8).toString(16)})}function le(e){return async t=>{var o,s,a,p,d,g,c,C,w,u;if(x())return await e(t);let r={requestId:`ssr_${T()}`,url:t.resolvedUrl||((o=t.req)==null?void 0:o.url)||"unknown",method:((s=t.req)==null?void 0:s.method)||"SSR",userAgent:((p=(a=t.req)==null?void 0:a.headers)==null?void 0:p["user-agent"])||"unknown",ip:((g=(d=t.req)==null?void 0:d.headers)==null?void 0:g["x-forwarded-for"])||((C=(c=t.req)==null?void 0:c.headers)==null?void 0:C["x-real-ip"])||((u=(w=t.req)==null?void 0:w.connection)==null?void 0:u.remoteAddress)||"unknown",timestamp:new Date().toISOString()},n=new E(r);try{n.startCapturing();let m=await e(t);return n.stopCapturing(),n.printSummary(),m}catch(m){throw n.stopCapturing(),n.printSummary(m),m}}}function ce(e){return async t=>{var o,s,a,p,d,g,c,C,w,u;if(x())return console.log(`\u{1F5A5}\uFE0F getInitialProps (client-side) for: ${t.pathname}`),await e(t);let r={requestId:`initial_${T()}`,url:t.pathname||((o=t.req)==null?void 0:o.url)||"unknown",method:((s=t.req)==null?void 0:s.method)||"INITIAL",userAgent:((p=(a=t.req)==null?void 0:a.headers)==null?void 0:p["user-agent"])||"unknown",ip:((g=(d=t.req)==null?void 0:d.headers)==null?void 0:g["x-forwarded-for"])||((C=(c=t.req)==null?void 0:c.headers)==null?void 0:C["x-real-ip"])||((u=(w=t.req)==null?void 0:w.connection)==null?void 0:u.remoteAddress)||"unknown",timestamp:new Date().toISOString()},n=new E(r);try{n.startCapturing();let m=await e(t);return n.stopCapturing(),n.printSummary(),m}catch(m){throw n.stopCapturing(),n.printSummary(m),m}}}function ue(e){return async t=>{let r={requestId:`static_${T()}`,url:t.params?JSON.stringify(t.params):"index",method:"STATIC",userAgent:"Next.js Build",ip:"build-time",timestamp:new Date().toISOString()},n=new E(r);try{n.startCapturing();let o=await e(t);return n.stopCapturing(),n.printSummary(),o}catch(o){throw n.stopCapturing(),n.printSummary(o),o}}}function At(e,t="getServerSideProps"){switch(t){case "getServerSideProps":return le(e);case "getInitialProps":return ce(e);case "getStaticProps":return ue(e);default:throw new Error(`Unknown function type: ${t}`)}}function M(e){return async(t,r)=>{var d,g;let n={requestId:t.headers["x-request-id"]||T(),url:t.url,method:t.method,userAgent:t.headers["user-agent"]||"unknown",ip:t.headers["x-forwarded-for"]||t.headers["x-real-ip"]||((d=t.connection)==null?void 0:d.remoteAddress)||((g=t.socket)==null?void 0:g.remoteAddress)||"unknown",timestamp:new Date().toISOString()},o=new E(n);t.logger=o;try{r.headersSent||(r.setHeader("x-request-id",n.requestId),r.setHeader("x-timestamp",n.timestamp));}catch(c){o.originalConsole.warn("Could not set response headers:",c.message);}let s=false,a=(c="finish")=>{if(!s){s=true;try{o.stopCapturing(),o.originalConsole.log(`\u2705 API Handler completed successfully (${c})`),o.printSummary();}catch(C){o.originalConsole.error(`Cleanup failed for ${n.requestId}:`,C.message),o.forceStopCapturing();}}};try{r.on("finish",()=>a("finish")),r.on("close",()=>a("close")),r.on("error",c=>{o.originalConsole.error(`Response error: ${c.message}`),a("error");});}catch(c){o.originalConsole.warn("Could not attach response listeners:",c.message);}let p=setTimeout(()=>{s||(o.originalConsole.warn(`\u26A0\uFE0F Request ${n.requestId} exceeded 60s timeout, forcing cleanup`),a("timeout"));},6e4);try{o.startCapturing();let c=await e(t,r);return clearTimeout(p),c}catch(c){if(clearTimeout(p),!s){s=true;try{o.stopCapturing(),o.printSummary(c);}catch{o.forceStopCapturing();}}throw c}}}var H=class{static wrap(t){return M(t)}};export{H as BaseApiHandler,ge as ProfileWrapperCard,me as ToastWrapper,re as UserContext,xe as capitalizeFirstLetter,Ce as changeEmailFormat,ye as checkCreditSumLimits,Z as checkIfProfileLocked,Y as checkIfProfileUnLocked,_e as click_chat_fun,be as combineTeamAndInviteData,ve as copy_to_clipboard,Ee as createImg,Te as deepClone,Oe as downloadCSV,De as downloadExcel,ht as formatContactDetails,Pe as formatCreditLimits,ne as formatEmails,oe as formatPhoneNumbers,Ve as formatTeamData,he as fromBase64ToFile,Ct as getAllValidationSchemas,We as getCookieValue,O as getIP,Je as getLockedUnlockProfiles,L as getValidationSchema,Ue as get_combined_location,Ne as get_days_to_month_years,Be as get_domain_name,N as get_formated_date,ze as get_formated_url,Me as get_next_billing_date,He as get_remaining_days,x as isBrowser,wt as isValidationConfigInitialized,Ke as readExcelCSV,Qe as refactor_ln_urls,bt as request_caller,yt as resetValidationConfig,Ie as restructureData,Ye as scrollTo,Ze as scrollToById,St as serverRequestHandler,xt as setValidationConfig,z as table_filter_rows,tt as underscoresNormalText,rt as updatePlural,st as useOnScreen,lt as useQuery,ft as useUser,dt as useWindowSize,q as verify_and_decrypt_jwt,M as withGlobalLogging,ce as withInitialPropsLogging,At as withPageLogging,le as withServerSideLogging,ue as withStaticPropsLogging};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map